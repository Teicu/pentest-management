<?php
/**
 * Author: Damian Schwyrz <mail@damianschwyrz.de>
 * URL: https://www.damianschwyrz.de
 * Copyright (c) 2018.
 */

namespace App\Task;


use App\Target;

class GetHttpResponseForHttpsOrHttpUrl
{

    /**
     * @param \App\Target $target
     *
     * @return array
     */
    public static function start(Target $target): array
    {
        $httpUrl = "https://" . $target->subdomain;

        $crawler = new CrawlUrl($httpUrl);
        $crawler->start();
        $response = $crawler->getResponse();


        if ($response['http_status'] == 0) {
            $httpUrl = "http://" . $target->subdomain;
            $crawler = new CrawlUrl($httpUrl);
            $crawler->start();
            $response = $crawler->getResponse();
        }

        return [$httpUrl, $response];
    }
}